name: GitHub Actions POC
on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Select the environment for deployment'
        required: true
        default: '-'
        type: choice
        options:
          - dev
          - staging
          - prod
      skip_dev_if_staging:
        description: 'If deploying to Staging, do you want to skip deployment in Dev?'
        required: false
        default: 'no'
        type: choice
        options:
          - 'yes'
          - 'no'

    #   ticket:
    #     description: 'Ticket Number (required for prod)'
    #     required: false
    #     default: '-'
       

jobs:
  log-info:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ§¾ Log GitHub Ref
        run: |
            echo "ğŸ”— GitHub Ref: $GITHUB_REF"
      - name: ğŸš€ Deploy to selected environment
        run: |
            echo "Deploying to ${{ github.event.inputs.environment }}"

      - name: ğŸ“„ Log Ticket number
        run: |
          echo "Ticket Number: ${{ github.event.inputs.ticket }}"

      - name: âŒ Validate Ticket for prod
        if: ${{ github.event.inputs.environment == 'prod' && github.event.inputs.ticket == '-' }}
        run: |
          echo "::error::Ticket number is required for production deployment!"
          exit 1
      - name: ğŸš€ Deploy to Dev
        if: ${{ github.event.inputs.environment == 'dev' || (github.event.inputs.environment == 'staging' && github.event.inputs.skip_dev_if_staging == 'no') }}
        run: echo "âœ… Deploying to Dev..."

      - name: ğŸš€ Deploy to Staging
        if: ${{ github.event.inputs.environment == 'staging' }}
        run: echo "âœ… Deploying to Staging..."

      - name: ğŸš€ Deploy to Prod
        if: ${{ github.event.inputs.environment == 'prod' }}
        run: echo "âœ… Deploying to Prod..."
     